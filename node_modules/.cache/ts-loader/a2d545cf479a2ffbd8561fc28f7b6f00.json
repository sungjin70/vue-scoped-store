{"remainingRequest":"C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\babel-loader\\lib\\index.js!C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\ts-loader\\index.js??ref--13-2!C:\\project\\scoped-store\\vue-scoped-store\\src\\scoped-store\\core\\any-type-store-service.ts","dependencies":[{"path":"C:\\project\\scoped-store\\vue-scoped-store\\src\\scoped-store\\core\\any-type-store-service.ts","mtime":1624658697364},{"path":"C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiQzovcHJvamVjdC9zY29wZWQtc3RvcmUvdnVlLXNjb3BlZC1zdG9yZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiQzovcHJvamVjdC9zY29wZWQtc3RvcmUvdnVlLXNjb3BlZC1zdG9yZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkM6L3Byb2plY3Qvc2NvcGVkLXN0b3JlL3Z1ZS1zY29wZWQtc3RvcmUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9pbmhlcml0cyBmcm9tICJDOi9wcm9qZWN0L3Njb3BlZC1zdG9yZS92dWUtc2NvcGVkLXN0b3JlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9pbmhlcml0cyI7CmltcG9ydCBfY3JlYXRlU3VwZXIgZnJvbSAiQzovcHJvamVjdC9zY29wZWQtc3RvcmUvdnVlLXNjb3BlZC1zdG9yZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlU3VwZXIiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgeyBCYXNlU3RvcmVTZXJ2aWNlIH0gZnJvbSAnLi9iYXNlLXN0b3JlLXNlcnZpY2UnOwppbXBvcnQgXyBmcm9tICdsb2Rhc2gnOwp2YXIgaW5pdGlhbFN0YXRlID0gewogIHVwZGF0ZXI6ICcnLAogIHBheWxvYWQ6IG51bGwKfTsKZXhwb3J0IHZhciBBbnlUeXBlU3RvcmVTZXJ2aWNlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQmFzZVN0b3JlU2VydmljZSkgewogIF9pbmhlcml0cyhBbnlUeXBlU3RvcmVTZXJ2aWNlLCBfQmFzZVN0b3JlU2VydmljZSk7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoQW55VHlwZVN0b3JlU2VydmljZSk7CgogIGZ1bmN0aW9uIEFueVR5cGVTdG9yZVNlcnZpY2UoKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFueVR5cGVTdG9yZVNlcnZpY2UpOwoKICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgaW5pdGlhbFN0YXRlKTsKICAgIF90aGlzLiRzdGF0ZSA9IF90aGlzLnNlbGVjdChmdW5jdGlvbiAoc3RhdGUpIHsKICAgICAgcmV0dXJuIHN0YXRlLnBheWxvYWQ7CiAgICB9KTsKICAgIF90aGlzLiRjb21tYW5kID0gX3RoaXMuc2VsZWN0Q29tbWFuZChmdW5jdGlvbiAoY29tbWFuZCkgewogICAgICByZXR1cm4gY29tbWFuZDsKICAgIH0pOwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEFueVR5cGVTdG9yZVNlcnZpY2UsIFt7CiAgICBrZXk6ICJzZWxlY3REYXRhRnJvbU90aGVycyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2VsZWN0RGF0YUZyb21PdGhlcnMocmVjZWl2ZXIpIHsKICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0KGZ1bmN0aW9uIChzdGF0ZSkgewogICAgICAgIHJldHVybiBzdGF0ZTsKICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uIChfcmVmKSB7CiAgICAgICAgdmFyIHVwZGF0ZXIgPSBfcmVmLnVwZGF0ZXI7CiAgICAgICAgcmV0dXJuIHJlY2VpdmVyICE9IHVwZGF0ZXI7CiAgICAgIH0pLm1hcChmdW5jdGlvbiAoc3RhdGUpIHsKICAgICAgICByZXR1cm4gc3RhdGUucGF5bG9hZDsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAic2VsZWN0RGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2VsZWN0RGF0YShwYXRoLCByZWNlaXZlcikgewogICAgICB2YXIgcmVzdWx0OwoKICAgICAgaWYgKHJlY2VpdmVyKSB7CiAgICAgICAgcmVzdWx0ID0gdGhpcy5zZWxlY3REYXRhRnJvbU90aGVycyhyZWNlaXZlcik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVzdWx0ID0gdGhpcy5zZWxlY3QoZnVuY3Rpb24gKHN0YXRlKSB7CiAgICAgICAgICByZXR1cm4gc3RhdGUucGF5bG9hZDsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdC5tYXAoZnVuY3Rpb24gKHBheWxvYWQpIHsKICAgICAgICByZXR1cm4gXy5nZXQocGF5bG9hZCwgcGF0aCk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInNlbmREYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZW5kRGF0YShwYXlsb2FkLCBzZW5kZXIsIHBhdGgpIHsKICAgICAgaWYgKCFwYXRoKSB7CiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICB1cGRhdGVyOiBzZW5kZXIsCiAgICAgICAgICBwYXlsb2FkOiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHRoaXMuc3RhdGUucGF5bG9hZCksIHBheWxvYWQpCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIHN0YXRlID0gewogICAgICAgICAgdXBkYXRlcjogc2VuZGVyLAogICAgICAgICAgcGF5bG9hZDogX29iamVjdFNwcmVhZCh7fSwgdGhpcy5zdGF0ZS5wYXlsb2FkKQogICAgICAgIH07CiAgICAgICAgaWYgKCFzdGF0ZS5wYXlsb2FkKSBzdGF0ZS5wYXlsb2FkID0ge307CgogICAgICAgIF8uc2V0KHN0YXRlLnBheWxvYWQsIHBhdGgsIHBheWxvYWQpOwoKICAgICAgICB0aGlzLnNldFN0YXRlKHN0YXRlKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInNlbmRDb21tYW5kIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZW5kQ29tbWFuZChjb21tYW5kLCBhcmd1bWVudCwgc2VuZGVyKSB7CiAgICAgIHZhciBjb21tYW5kT2JqID0gewogICAgICAgIHNlbmRlcjogc2VuZGVyLAogICAgICAgIGNvbW1hbmQ6IGNvbW1hbmQsCiAgICAgICAgYXJndW1lbnQ6IGFyZ3VtZW50CiAgICAgIH07CiAgICAgIHRoaXMuc2V0Q29tbWFuZChjb21tYW5kT2JqKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBBbnlUeXBlU3RvcmVTZXJ2aWNlOwp9KEJhc2VTdG9yZVNlcnZpY2UpOw=="},{"version":3,"sources":["C:\\project\\scoped-store\\vue-scoped-store\\src\\scoped-store\\core\\any-type-store-service.ts"],"names":[],"mappings":";;;;;;;AAAA,SAAQ,gBAAR,QAA+B,sBAA/B;AAEA,OAAO,CAAP,MAAc,QAAd;AAaA,IAAM,YAAY,GAAiB;AAC/B,EAAA,OAAO,EAAC,EADuB;AAE/B,EAAA,OAAO,EAAE;AAFsB,CAAnC;AAKA,WAAa,mBAAb;AAAA;;AAAA;;AAKI,iCAAA;AAAA;;AAAA;;AACE,8BAAM,YAAN;AAJK,UAAA,MAAA,GAAkC,MAAK,MAAL,CAAY,UAAA,KAAK;AAAA,aAAI,KAAK,CAAC,OAAV;AAAA,KAAjB,CAAlC;AACA,UAAA,QAAA,GAA0C,MAAK,aAAL,CAAmB,UAAA,OAAO;AAAA,aAAI,OAAJ;AAAA,KAA1B,CAA1C;AAEP;AAEC;;AAPL;AAAA;AAAA,WASY,8BAAqB,QAArB,EAAoC;AACxC,aAAO,KAAK,MAAL,CAAY,UAAA,KAAK;AAAA,eAAI,KAAJ;AAAA,OAAjB,EACF,MADE,CACK;AAAA,YAAE,OAAF,QAAE,OAAF;AAAA,eAAe,QAAQ,IAAI,OAA3B;AAAA,OADL,EAEF,GAFE,CAEE,UAAA,KAAK;AAAA,eAAI,KAAK,CAAC,OAAV;AAAA,OAFP,CAAP;AAGH;AAbL;AAAA;AAAA,WAeW,oBAAW,IAAX,EAAwB,QAAxB,EAAwC;AAC3C,UAAI,MAAJ;;AACA,UAAI,QAAJ,EAAc;AACV,QAAA,MAAM,GAAG,KAAK,oBAAL,CAA0B,QAA1B,CAAT;AACH,OAFD,MAGK;AACD,QAAA,MAAM,GAAG,KAAK,MAAL,CAAY,UAAA,KAAK;AAAA,iBAAI,KAAK,CAAC,OAAV;AAAA,SAAjB,CAAT;AACH;;AAED,aAAO,MAAM,CAAC,GAAP,CAAW,UAAA,OAAO;AAAA,eAAI,CAAC,CAAC,GAAF,CAAM,OAAN,EAAe,IAAf,CAAJ;AAAA,OAAlB,CAAP;AACH;AAzBL;AAAA;AAAA,WA2BW,kBAAS,OAAT,EAAuB,MAAvB,EAAsC,IAAtC,EAAkD;AACrD,UAAI,CAAC,IAAL,EAAW;AACP,aAAK,QAAL,CAAc;AACV,UAAA,OAAO,EAAE,MADC;AAEV,UAAA,OAAO,kCACJ,KAAK,KAAL,CAAW,OADP,GAEJ,OAFI;AAFG,SAAd;AAOH,OARD,MASK;AACD,YAAM,KAAK,GAAG;AACV,UAAA,OAAO,EAAE,MADC;AAEV,UAAA,OAAO,oBACJ,KAAK,KAAL,CAAW,OADP;AAFG,SAAd;AAOA,YAAI,CAAC,KAAK,CAAC,OAAX,EACI,KAAK,CAAC,OAAN,GAAgB,EAAhB;;AAEJ,QAAA,CAAC,CAAC,GAAF,CAAM,KAAK,CAAC,OAAZ,EAAoB,IAApB,EAAyB,OAAzB;;AACA,aAAK,QAAL,CAAc,KAAd;AACH;AACJ;AAnDL;AAAA;AAAA,WAqDW,qBAAY,OAAZ,EAA6B,QAA7B,EAA4C,MAA5C,EAA0D;AAC7D,UAAM,UAAU,GAAsB;AAClC,QAAA,MAAM,EAAN,MADkC;AAElC,QAAA,OAAO,EAAP,OAFkC;AAGlC,QAAA,QAAQ,EAAR;AAHkC,OAAtC;AAMA,WAAK,UAAL,CAAgB,UAAhB;AACH;AA7DL;;AAAA;AAAA,EAAyC,gBAAzC","sourcesContent":["import {BaseStoreService} from './base-store-service';\r\nimport { Observable } from 'rxjs';\r\nimport _ from 'lodash';\r\n\r\nexport interface AnyTypeState {\r\n    updater:string;\r\n    payload: object|null;\r\n}\r\n\r\nexport interface StringTypeCommand {\r\n    sender?:string | undefined;\r\n    command:string;\r\n    argument?: any;\r\n}\r\n\r\nconst initialState: AnyTypeState = {\r\n    updater:'',\r\n    payload: null\r\n}\r\n\r\nexport class AnyTypeStoreService extends BaseStoreService<AnyTypeState, StringTypeCommand> {\r\n\r\n    public $state: Observable<object|null> = this.select(state => state.payload);\r\n    public $command: Observable<StringTypeCommand> = this.selectCommand(command => command);\r\n\r\n    constructor() {\r\n      super(initialState)\r\n    }\r\n\r\n    private selectDataFromOthers(receiver:string) {\r\n        return this.select(state => state)\r\n            .filter(({updater}) => receiver != updater)\r\n            .map(state => state.payload);\r\n    }\r\n\r\n    public selectData(path:string, receiver?:string) {\r\n        let result;\r\n        if (receiver) {\r\n            result = this.selectDataFromOthers(receiver)\r\n        }\r\n        else {\r\n            result = this.select(state => state.payload);\r\n        }\r\n        \r\n        return result.map(payload => _.get(payload, path));\r\n    }\r\n\r\n    public sendData(payload: any, sender:string, path?:string) {\r\n        if (!path) {\r\n            this.setState({\r\n                updater: sender,\r\n                payload: {\r\n                ...this.state.payload,\r\n                ...payload,\r\n                },\r\n            });\r\n        }\r\n        else {\r\n            const state = {\r\n                updater: sender,\r\n                payload: {\r\n                ...this.state.payload,\r\n                },\r\n            };\r\n\r\n            if (!state.payload)\r\n                state.payload = {};\r\n\r\n            _.set(state.payload,path,payload);\r\n            this.setState(state);\r\n        }\r\n    }\r\n\r\n    public sendCommand(command: string, argument?:any, sender?:string) {\r\n        const commandObj: StringTypeCommand = {\r\n            sender,\r\n            command,\r\n            argument,\r\n        };\r\n\r\n        this.setCommand(commandObj);\r\n    }\r\n}\r\n"],"sourceRoot":""}]}