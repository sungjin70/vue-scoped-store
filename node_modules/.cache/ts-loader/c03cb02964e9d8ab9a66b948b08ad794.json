{"remainingRequest":"C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\babel-loader\\lib\\index.js!C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\ts-loader\\index.js??ref--13-2!C:\\project\\scoped-store\\vue-scoped-store\\src\\scoped-store\\core\\base-store-service.ts","dependencies":[{"path":"C:\\project\\scoped-store\\vue-scoped-store\\src\\scoped-store\\core\\base-store-service.ts","mtime":1624658641684},{"path":"C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiQzovcHJvamVjdC9zY29wZWQtc3RvcmUvdnVlLXNjb3BlZC1zdG9yZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiQzovcHJvamVjdC9zY29wZWQtc3RvcmUvdnVlLXNjb3BlZC1zdG9yZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkM6L3Byb2plY3Qvc2NvcGVkLXN0b3JlL3Z1ZS1zY29wZWQtc3RvcmUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF90eXBlb2YgZnJvbSAiQzovcHJvamVjdC9zY29wZWQtc3RvcmUvdnVlLXNjb3BlZC1zdG9yZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdHlwZW9mIjsKaW1wb3J0IHsgQmVoYXZpb3JTdWJqZWN0LCBTdWJqZWN0IH0gZnJvbSAncnhqcyc7CmltcG9ydCB7IGRpc3RpbmN0VW50aWxDaGFuZ2VkLCBtYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7CmV4cG9ydCB2YXIgaXNQcmltaXRpdmUgPSBmdW5jdGlvbiBpc1ByaW1pdGl2ZSh2YWx1ZSkgewogIHZhciB0eXBlID0gX3R5cGVvZih2YWx1ZSk7CgogIHJldHVybiB2YWx1ZSA9PSBudWxsIHx8IHR5cGUgIT09ICJvYmplY3QiICYmIHR5cGUgIT09ICJmdW5jdGlvbiI7Cn07CmV4cG9ydCB2YXIgQmFzZVN0b3JlU2VydmljZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQmFzZVN0b3JlU2VydmljZShpbml0aWFsU3RhdGUpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCYXNlU3RvcmVTZXJ2aWNlKTsKCiAgICB0aGlzLnN0YXRlJCA9IG5ldyBCZWhhdmlvclN1YmplY3QoaW5pdGlhbFN0YXRlKTsKICAgIHRoaXMuY29tbWFuZE1hcHBlciQgPSBuZXcgU3ViamVjdCgpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEJhc2VTdG9yZVNlcnZpY2UsIFt7CiAgICBrZXk6ICJzdGF0ZSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3RhdGUkLmdldFZhbHVlKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAic2VsZWN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZWxlY3QobWFwRm4pIHsKICAgICAgcmV0dXJuIHRoaXMuc3RhdGUkLmFzT2JzZXJ2YWJsZSgpLnBpcGUobWFwKGZ1bmN0aW9uIChzdGF0ZSkgewogICAgICAgIHJldHVybiBtYXBGbihzdGF0ZSk7CiAgICAgIH0pLCBkaXN0aW5jdFVudGlsQ2hhbmdlZCgpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZWxlY3RDb21tYW5kIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZWxlY3RDb21tYW5kKG1hcEZuKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbW1hbmRNYXBwZXIkLmFzT2JzZXJ2YWJsZSgpLnBpcGUobWFwKGZ1bmN0aW9uIChzdGF0ZSkgewogICAgICAgIHJldHVybiBtYXBGbihzdGF0ZSk7CiAgICAgIH0pKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRTdGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0U3RhdGUobmV3U3RhdGUpIHsKICAgICAgdGhpcy5zdGF0ZSQubmV4dChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHRoaXMuc3RhdGUpLCBuZXdTdGF0ZSkpOwogICAgfQogIH0sIHsKICAgIGtleTogInNldENvbW1hbmQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldENvbW1hbmQobmV3Q29tbWFuZCkgewogICAgICB0aGlzLmNvbW1hbmRNYXBwZXIkLm5leHQobmV3Q29tbWFuZCk7CiAgICB9CiAgfSwgewogICAga2V5OiAic3RvcCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3RvcCgpIHsKICAgICAgdGhpcy5zdGF0ZSQuY29tcGxldGUoKTsKICAgICAgdGhpcy5jb21tYW5kTWFwcGVyJC5jb21wbGV0ZSgpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEJhc2VTdG9yZVNlcnZpY2U7Cn0oKTs="},{"version":3,"sources":["C:\\project\\scoped-store\\vue-scoped-store\\src\\scoped-store\\core\\base-store-service.ts"],"names":[],"mappings":";;;;AAAA,SAAS,eAAT,EAA0B,OAA1B,QAAqD,MAArD;AACA,SAAS,oBAAT,EAA+B,GAA/B,QAA0C,gBAA1C;AAEA,OAAO,IAAM,WAAW,GAAG,SAAd,WAAc,CAAC,KAAD,EAAwB;AACjD,MAAM,IAAI,WAAU,KAAV,CAAV;;AACA,SAAO,KAAK,IAAI,IAAT,IAAkB,IAAI,KAAK,QAAT,IAAqB,IAAI,KAAK,UAAvD;AACD,CAHM;AAKP,WAAa,gBAAb;AAQE,4BAAY,YAAZ,EAA4B;AAAA;;AAC1B,SAAK,MAAL,GAAc,IAAI,eAAJ,CAAwB,YAAxB,CAAd;AACA,SAAK,cAAL,GAAsB,IAAI,OAAJ,EAAtB;AACD;;AAXH;AAAA;AAAA,SAIE,eAAmB;AACjB,aAAO,KAAK,MAAL,CAAY,QAAZ,EAAP;AACD;AANH;AAAA;AAAA,WAaY,gBAAU,KAAV,EAAiC;AACzC,aAAO,KAAK,MAAL,CAAY,YAAZ,GAA2B,IAA3B,CACL,GAAG,CAAC,UAAC,KAAD;AAAA,eAAe,KAAK,CAAC,KAAD,CAApB;AAAA,OAAD,CADE,EAEL,oBAAoB,EAFf,CAAP;AAID;AAlBH;AAAA;AAAA,WAoBY,uBAAiB,KAAjB,EAAwC;AAChD,aAAO,KAAK,cAAL,CAAoB,YAApB,GAAmC,IAAnC,CACL,GAAG,CAAC,UAAC,KAAD;AAAA,eAAe,KAAK,CAAC,KAAD,CAApB;AAAA,OAAD,CADE,CAAP;AAGD;AAxBH;AAAA;AAAA,WA0BY,kBAAS,QAAT,EAA8B;AACtC,WAAK,MAAL,CAAY,IAAZ,iCACK,KAAK,KADV,GAEK,QAFL;AAID;AA/BH;AAAA;AAAA,WAiCY,oBAAW,UAAX,EAAyB;AACjC,WAAK,cAAL,CAAoB,IAApB,CAAyB,UAAzB;AACD;AAnCH;AAAA;AAAA,WAqCS,gBAAI;AACT,WAAK,MAAL,CAAY,QAAZ;AACA,WAAK,cAAL,CAAoB,QAApB;AACD;AAxCH;;AAAA;AAAA","sourcesContent":["import { BehaviorSubject, Subject, Observable } from 'rxjs';\nimport { distinctUntilChanged, map } from 'rxjs/operators';\n\nexport const isPrimitive = (value: any): boolean => {\n  const type = typeof value;\n  return value == null || (type !== \"object\" && type !== \"function\");\n}\n\nexport class BaseStoreService<ST, CT> {\n  private state$: BehaviorSubject<ST>;\n  private commandMapper$: Subject<CT>;\n\n  protected get state(): ST {\n    return this.state$.getValue();\n  }\n\n  constructor(initialState: ST) {\n    this.state$ = new BehaviorSubject<ST>(initialState);\n    this.commandMapper$ = new Subject<CT>();\n  }\n\n  protected select<K>(mapFn: (state: ST) => K): Observable<K> {\n    return this.state$.asObservable().pipe(\n      map((state: ST) => mapFn(state)),\n      distinctUntilChanged()\n    );\n  }\n\n  protected selectCommand<K>(mapFn: (state: CT) => K): Observable<K> {\n    return this.commandMapper$.asObservable().pipe(\n      map((state: CT) => mapFn(state))\n    );\n  }\n\n  protected setState(newState: Partial<ST>) {\n    this.state$.next({\n      ...this.state,\n      ...newState,\n    });\n  }\n\n  protected setCommand(newCommand: CT) {\n    this.commandMapper$.next(newCommand);\n  }\n\n  public stop() {\n    this.state$.complete();\n    this.commandMapper$.complete();\n  }\n}\n"],"sourceRoot":""}]}