{"remainingRequest":"C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\babel-loader\\lib\\index.js!C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\ts-loader\\index.js??ref--13-2!C:\\project\\scoped-store\\vue-scoped-store\\src\\scoped-store\\core\\any-type-store-service.ts","dependencies":[{"path":"C:\\project\\scoped-store\\vue-scoped-store\\src\\scoped-store\\core\\any-type-store-service.ts","mtime":1630108481995},{"path":"C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiQzovcHJvamVjdC9zY29wZWQtc3RvcmUvdnVlLXNjb3BlZC1zdG9yZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiQzovcHJvamVjdC9zY29wZWQtc3RvcmUvdnVlLXNjb3BlZC1zdG9yZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkM6L3Byb2plY3Qvc2NvcGVkLXN0b3JlL3Z1ZS1zY29wZWQtc3RvcmUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9pbmhlcml0cyBmcm9tICJDOi9wcm9qZWN0L3Njb3BlZC1zdG9yZS92dWUtc2NvcGVkLXN0b3JlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9pbmhlcml0cyI7CmltcG9ydCBfY3JlYXRlU3VwZXIgZnJvbSAiQzovcHJvamVjdC9zY29wZWQtc3RvcmUvdnVlLXNjb3BlZC1zdG9yZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlU3VwZXIiOwppbXBvcnQgeyBCYXNlU3RvcmVTZXJ2aWNlIH0gZnJvbSAnLi9iYXNlLXN0b3JlLXNlcnZpY2UnOwppbXBvcnQgXyBmcm9tICdsb2Rhc2gnOwp2YXIgaW5pdGlhbFN0YXRlID0gewogIHVwZGF0ZXI6IHt9LAogIHBheWxvYWQ6IG51bGwKfTsKZXhwb3J0IHZhciBBbnlUeXBlU3RvcmVTZXJ2aWNlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQmFzZVN0b3JlU2VydmljZSkgewogIF9pbmhlcml0cyhBbnlUeXBlU3RvcmVTZXJ2aWNlLCBfQmFzZVN0b3JlU2VydmljZSk7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoQW55VHlwZVN0b3JlU2VydmljZSk7CgogIGZ1bmN0aW9uIEFueVR5cGVTdG9yZVNlcnZpY2UoKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFueVR5cGVTdG9yZVNlcnZpY2UpOwoKICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgaW5pdGlhbFN0YXRlKTsKICAgIF90aGlzLiRzdGF0ZSA9IF90aGlzLnNlbGVjdChmdW5jdGlvbiAoc3RhdGUpIHsKICAgICAgcmV0dXJuIHN0YXRlOwogICAgfSk7CiAgICBfdGhpcy4kcGF5bG9hZCA9IF90aGlzLnNlbGVjdChmdW5jdGlvbiAoc3RhdGUpIHsKICAgICAgcmV0dXJuIHN0YXRlLnBheWxvYWQ7CiAgICB9KTsKICAgIF90aGlzLiRjb21tYW5kID0gX3RoaXMuc2VsZWN0Q29tbWFuZChmdW5jdGlvbiAoY29tbWFuZCkgewogICAgICByZXR1cm4gY29tbWFuZDsKICAgIH0pOwogICAgcmV0dXJuIF90aGlzOwogIH0gLy8gcHJpdmF0ZSBzZWxlY3REYXRhRnJvbU90aGVycyhyZWNlaXZlcjpzdHJpbmcpIHsKICAvLyAgICAgcmV0dXJuIHRoaXMuc2VsZWN0KHN0YXRlID0+IHN0YXRlKQogIC8vICAgICAgICAgLmZpbHRlcigoe3VwZGF0ZXJ9KSA9PiByZWNlaXZlciAhPSB1cGRhdGVyKQogIC8vICAgICAgICAgLm1hcChzdGF0ZSA9PiBzdGF0ZS5wYXlsb2FkKTsKICAvLyB9CiAgLy8gcHVibGljIHNlbGVjdERhdGEocGF0aDpzdHJpbmcsIHJlY2VpdmVyPzpzdHJpbmcpIHsKICAvLyAgICAgbGV0IHJlc3VsdDsKICAvLyAgICAgaWYgKHJlY2VpdmVyKSB7CiAgLy8gICAgICAgICByZXN1bHQgPSB0aGlzLnNlbGVjdERhdGFGcm9tT3RoZXJzKHJlY2VpdmVyKQogIC8vICAgICB9CiAgLy8gICAgIGVsc2UgewogIC8vICAgICAgICAgcmVzdWx0ID0gdGhpcy5zZWxlY3Qoc3RhdGUgPT4gc3RhdGUucGF5bG9hZCk7CiAgLy8gICAgIH0KICAvLyAgICAgcmV0dXJuIHJlc3VsdC5tYXAocGF5bG9hZCA9PiBfLmdldChwYXlsb2FkLCBwYXRoKSk7CiAgLy8gfQoKCiAgX2NyZWF0ZUNsYXNzKEFueVR5cGVTdG9yZVNlcnZpY2UsIFt7CiAgICBrZXk6ICJzZW5kRGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2VuZERhdGEocGF5bG9hZCwgc2VuZE9wdCwgcGF0aCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBjb3B5ID0gXy5jbG9uZURlZXAocGF5bG9hZCk7CgogICAgICBjb25zb2xlLmxvZygnc2VuZERhdGEnLCBjb3B5KTsKICAgICAgdmFyIHN0YXRlOwoKICAgICAgaWYgKCFwYXRoKSB7CiAgICAgICAgc3RhdGUgPSB7CiAgICAgICAgICB1cGRhdGVyOiBfb2JqZWN0U3ByZWFkKHt9LCBzZW5kT3B0KSwKICAgICAgICAgIHBheWxvYWQ6IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgdGhpcy5zdGF0ZS5wYXlsb2FkKSwgY29weSkKICAgICAgICB9OwogICAgICB9IGVsc2UgewogICAgICAgIHN0YXRlID0gewogICAgICAgICAgdXBkYXRlcjogX29iamVjdFNwcmVhZCh7fSwgc2VuZE9wdCksCiAgICAgICAgICBwYXlsb2FkOiBfb2JqZWN0U3ByZWFkKHt9LCB0aGlzLnN0YXRlLnBheWxvYWQpCiAgICAgICAgfTsKICAgICAgICBpZiAoIXN0YXRlLnBheWxvYWQpIHN0YXRlLnBheWxvYWQgPSB7fTsKCiAgICAgICAgXy5zZXQoc3RhdGUucGF5bG9hZCwgcGF0aCwgY29weSk7CiAgICAgIH0KCiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzMi5zZXRTdGF0ZShzdGF0ZSk7CiAgICAgIH0sIDApOwogICAgICByZXR1cm4gY29weTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZW5kQ29tbWFuZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2VuZENvbW1hbmQoY29tbWFuZCwgYXJndW1lbnQsIHNlbmRlcikgewogICAgICB2YXIgY29tbWFuZE9iaiA9IHsKICAgICAgICBzZW5kZXI6IHNlbmRlciwKICAgICAgICBjb21tYW5kOiBjb21tYW5kLAogICAgICAgIGFyZ3VtZW50OiBhcmd1bWVudAogICAgICB9OwogICAgICB0aGlzLnNldENvbW1hbmQoY29tbWFuZE9iaik7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gQW55VHlwZVN0b3JlU2VydmljZTsKfShCYXNlU3RvcmVTZXJ2aWNlKTs="},{"version":3,"sources":["C:\\project\\scoped-store\\vue-scoped-store\\src\\scoped-store\\core\\any-type-store-service.ts"],"names":[],"mappings":";;;;;AAAA,SAAQ,gBAAR,QAA+B,sBAA/B;AAEA,OAAO,CAAP,MAAc,QAAd;AAaA,IAAM,YAAY,GAAiB;AAC/B,EAAA,OAAO,EAAC,EADuB;AAE/B,EAAA,OAAO,EAAE;AAFsB,CAAnC;AAKA,WAAa,mBAAb;AAAA;;AAAA;;AAMI,iCAAA;AAAA;;AAAA;;AACE,8BAAM,YAAN;AALK,UAAA,MAAA,GAA+B,MAAK,MAAL,CAAY,UAAA,KAAK;AAAA,aAAI,KAAJ;AAAA,KAAjB,CAA/B;AACA,UAAA,QAAA,GAAiC,MAAK,MAAL,CAAY,UAAA,KAAK;AAAA,aAAI,KAAK,CAAC,OAAV;AAAA,KAAjB,CAAjC;AACA,UAAA,QAAA,GAA0C,MAAK,aAAL,CAAmB,UAAA,OAAO;AAAA,aAAI,OAAJ;AAAA,KAA1B,CAA1C;AAEP;AAEC,GARL,CAUI;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;;;AA1BJ;AAAA;AAAA,WA4BW,kBAAS,OAAT,EAAuB,OAAvB,EAAmC,IAAnC,EAA+C;AAAA;;AAClD,UAAI,IAAI,GAAG,CAAC,CAAC,SAAF,CAAY,OAAZ,CAAX;;AACA,MAAA,OAAO,CAAC,GAAR,CAAY,UAAZ,EAAwB,IAAxB;AACA,UAAI,KAAJ;;AACA,UAAI,CAAC,IAAL,EAAW;AACP,QAAA,KAAK,GAAG;AACJ,UAAA,OAAO,oBAAM,OAAN,CADH;AAEJ,UAAA,OAAO,kCACJ,KAAK,KAAL,CAAW,OADP,GAEJ,IAFI;AAFH,SAAR;AAOH,OARD,MASK;AACD,QAAA,KAAK,GAAG;AACJ,UAAA,OAAO,oBAAM,OAAN,CADH;AAEJ,UAAA,OAAO,oBACJ,KAAK,KAAL,CAAW,OADP;AAFH,SAAR;AAOA,YAAI,CAAC,KAAK,CAAC,OAAX,EACI,KAAK,CAAC,OAAN,GAAgB,EAAhB;;AAEJ,QAAA,CAAC,CAAC,GAAF,CAAM,KAAK,CAAC,OAAZ,EAAqB,IAArB,EAA2B,IAA3B;AACH;;AAED,MAAA,UAAU,CAAC,YAAK;AACZ,QAAA,MAAI,CAAC,QAAL,CAAc,KAAd;AACH,OAFS,EAEP,CAFO,CAAV;AAIA,aAAO,IAAP;AACH;AA5DL;AAAA;AAAA,WA8DW,qBAAY,OAAZ,EAA6B,QAA7B,EAA4C,MAA5C,EAA0D;AAC7D,UAAM,UAAU,GAAsB;AAClC,QAAA,MAAM,EAAN,MADkC;AAElC,QAAA,OAAO,EAAP,OAFkC;AAGlC,QAAA,QAAQ,EAAR;AAHkC,OAAtC;AAMA,WAAK,UAAL,CAAgB,UAAhB;AACH;AAtEL;;AAAA;AAAA,EAAyC,gBAAzC","sourcesContent":["import {BaseStoreService} from './base-store-service';\r\nimport { Observable } from 'rxjs';\r\nimport _ from 'lodash';\r\n\r\nexport interface AnyTypeState {\r\n    updater:{};\r\n    payload: object|null;\r\n}\r\n\r\nexport interface StringTypeCommand {\r\n    sender?:{};\r\n    command:string;\r\n    argument?: any;\r\n}\r\n\r\nconst initialState: AnyTypeState = {\r\n    updater:{},\r\n    payload: null\r\n}\r\n\r\nexport class AnyTypeStoreService extends BaseStoreService<AnyTypeState, StringTypeCommand> {\r\n\r\n    public $state: Observable<any|null> = this.select(state => state);\r\n    public $payload: Observable<any|null> = this.select(state => state.payload);\r\n    public $command: Observable<StringTypeCommand> = this.selectCommand(command => command);\r\n\r\n    constructor() {\r\n      super(initialState)\r\n    }\r\n\r\n    // private selectDataFromOthers(receiver:string) {\r\n    //     return this.select(state => state)\r\n    //         .filter(({updater}) => receiver != updater)\r\n    //         .map(state => state.payload);\r\n    // }\r\n\r\n    // public selectData(path:string, receiver?:string) {\r\n    //     let result;\r\n    //     if (receiver) {\r\n    //         result = this.selectDataFromOthers(receiver)\r\n    //     }\r\n    //     else {\r\n    //         result = this.select(state => state.payload);\r\n    //     }\r\n        \r\n    //     return result.map(payload => _.get(payload, path));\r\n    // }\r\n\r\n    public sendData(payload: any, sendOpt:{}, path?:string) {\r\n        let copy = _.cloneDeep(payload);\r\n        console.log('sendData', copy);\r\n        let state:any;\r\n        if (!path) {\r\n            state = {\r\n                updater: {...sendOpt},\r\n                payload: {\r\n                ...this.state.payload,\r\n                ...copy,\r\n                },\r\n            };\r\n        }\r\n        else {\r\n            state = {\r\n                updater: {...sendOpt},\r\n                payload: {\r\n                ...this.state.payload,\r\n                },\r\n            };\r\n\r\n            if (!state.payload)\r\n                state.payload = {};\r\n\r\n            _.set(state.payload, path, copy);\r\n        }\r\n\r\n        setTimeout(() => {\r\n            this.setState(state);\r\n        }, 0);\r\n\r\n        return copy;\r\n    }\r\n\r\n    public sendCommand(command: string, argument?:any, sender?:string) {\r\n        const commandObj: StringTypeCommand = {\r\n            sender,\r\n            command,\r\n            argument,\r\n        };\r\n\r\n        this.setCommand(commandObj);\r\n    }\r\n}\r\n"],"sourceRoot":""}]}