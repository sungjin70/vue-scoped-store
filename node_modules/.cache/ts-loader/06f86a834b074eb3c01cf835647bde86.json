{"remainingRequest":"C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\babel-loader\\lib\\index.js!C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\ts-loader\\index.js??ref--13-2!C:\\project\\scoped-store\\vue-scoped-store\\src\\scoped-store\\scoped-store-mixin.ts","dependencies":[{"path":"C:\\project\\scoped-store\\vue-scoped-store\\src\\scoped-store\\scoped-store-mixin.ts","mtime":1626602108942},{"path":"C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\project\\scoped-store\\vue-scoped-store\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90eXBlb2YgZnJvbSAiQzovcHJvamVjdC9zY29wZWQtc3RvcmUvdnVlLXNjb3BlZC1zdG9yZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdHlwZW9mIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJDOi9wcm9qZWN0L3Njb3BlZC1zdG9yZS92dWUtc2NvcGVkLXN0b3JlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiQzovcHJvamVjdC9zY29wZWQtc3RvcmUvdnVlLXNjb3BlZC1zdG9yZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIkM6L3Byb2plY3Qvc2NvcGVkLXN0b3JlL3Z1ZS1zY29wZWQtc3RvcmUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKaW1wb3J0IF9jcmVhdGVTdXBlciBmcm9tICJDOi9wcm9qZWN0L3Njb3BlZC1zdG9yZS92dWUtc2NvcGVkLXN0b3JlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVTdXBlciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnN0YXJ0cy13aXRoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktbmFtZXMuanMiOwppbXBvcnQgeyBfX2RlY29yYXRlIH0gZnJvbSAidHNsaWIiOwppbXBvcnQgQ29tcG9uZW50IGZyb20gJ3Z1ZS1jbGFzcy1jb21wb25lbnQnOwppbXBvcnQgVnVlIGZyb20gJ3Z1ZSc7CmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7CmltcG9ydCB7IEFueVR5cGVTdG9yZVNlcnZpY2UgfSBmcm9tICIuL2NvcmUvYW55LXR5cGUtc3RvcmUtc2VydmljZSI7CmltcG9ydCB7IHNjb3BlZFN0b3JlTWFuYWdlciB9IGZyb20gIi4vc2NvcGVkLXN0b3JlLW1hbmFnZXIiOwoKdmFyIFNjb3BlZFN0b3JlQ29tcG9uZW50ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfVnVlKSB7CiAgX2luaGVyaXRzKFNjb3BlZFN0b3JlQ29tcG9uZW50LCBfVnVlKTsKCiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihTY29wZWRTdG9yZUNvbXBvbmVudCk7CgogIGZ1bmN0aW9uIFNjb3BlZFN0b3JlQ29tcG9uZW50KCkgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTY29wZWRTdG9yZUNvbXBvbmVudCk7CgogICAgX3RoaXMgPSBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIF90aGlzLmRhdGFUcmFuTWFuYWdlciA9IHNjb3BlZFN0b3JlTWFuYWdlcjsKICAgIF90aGlzLnN1YnNjcmlwdGlvbnNGb3JQYWdlID0gW107CiAgICBfdGhpcy5zdWJzY3JpcHRpb25zRm9yR2xvYmFsID0gW107CiAgICBfdGhpcy5wYXRoTWFwRm9yUGFnZSA9IG5ldyBNYXAoKTsKICAgIF90aGlzLnBhdGhNYXBGb3JHbG9iYWwgPSBuZXcgTWFwKCk7CiAgICBfdGhpcy5pc1BhZ2UgPSBmYWxzZTsgLy8gcHJpdmF0ZSBpbml0UGFnZURhdGFTZXJ2aWNlKCkgewogICAgLy8gICAgIGlmICghdGhpcy5kYXRhVHJhbk1hbmFnZXIucGFnZURhdGFTZXJ2aWNlKSB7CiAgICAvLyAgICAgICAgIHRoaXMuZGF0YVRyYW5NYW5hZ2VyLnBhZ2VEYXRhU2VydmljZSA9IG5ldyBBbnlUeXBlU3RvcmVTZXJ2aWNlKCk7CiAgICAvLyAgICAgICAgIGNvbnNvbGUubG9nKCJkYXRhVHJhbk1hbmFnZXIucGFnZURhdGFTZXJ2aWNlIGNyZWF0ZWQiKTsKICAgIC8vICAgICB9CiAgICAvLyB9CgogICAgX3RoaXMuc2VuZGVySWRlbnRpdHkgPSB7fTsKICAgIF90aGlzLmdsb2JhbERhdGFTZXJ2aWNlS2V5ID0gIiQkR0xPQkFMX1NUT1JFX1NFUlZJQ0UkJCI7CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoU2NvcGVkU3RvcmVDb21wb25lbnQsIFt7CiAgICBrZXk6ICJjcmVhdGVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgICAvLyBjb25zb2xlLmxvZygnU2NvcGVkU3RvcmVDb21wb25lbnQuY3JlYXRlZCgpJyk7CiAgICAgIHRoaXMuaW5pdCgpOwogICAgfQogIH0sIHsKICAgIGtleTogImJlZm9yZURlc3Ryb3kiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGJlZm9yZURlc3Ryb3koKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKCdTY29wZWRTdG9yZUNvbXBvbmVudC5iZWZvcmVEZXN0cm95KCknKTsKICAgICAgZm9yICh2YXIgayBpbiB0aGlzLnN1YnNjcmlwdGlvbnNGb3JHbG9iYWwpIHsKICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnNGb3JHbG9iYWxba10udW5zdWJzY3JpYmUoKTsKICAgICAgfQoKICAgICAgZm9yICh2YXIgX2sgaW4gdGhpcy5zdWJzY3JpcHRpb25zRm9yUGFnZSkgewogICAgICAgIHRoaXMuc3Vic2NyaXB0aW9uc0ZvclBhZ2VbX2tdLnVuc3Vic2NyaWJlKCk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmlzUGFnZSkgewogICAgICAgIHZhciBfdGhpcyRwYWdlRGF0YVNlcnZpY2U7CgogICAgICAgIGNvbnNvbGUubG9nKCdpZiAodGhpcy5pc1BhZ2UpIGluIFNjb3BlZFN0b3JlQ29tcG9uZW50LmJlZm9yZURlc3Ryb3koKScpOwogICAgICAgIChfdGhpcyRwYWdlRGF0YVNlcnZpY2UgPSB0aGlzLnBhZ2VEYXRhU2VydmljZSkgPT09IG51bGwgfHwgX3RoaXMkcGFnZURhdGFTZXJ2aWNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRwYWdlRGF0YVNlcnZpY2Uuc3RvcCgpOyAvLyB0aGlzLmRhdGFUcmFuTWFuYWdlci5wYWdlRGF0YVNlcnZpY2UgPSB1bmRlZmluZWQ7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJpbml0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciB2bSA9IHRoaXM7IC8vIGNvbnNvbGUubG9nKCdTY29wZWRTdG9yZUNvbXBvbmVudC5pbml0KCknKTsKCiAgICAgIHZhciBwcyA9IHZtLiRvcHRpb25zLnBhZ2VTdG9yZTsKCiAgICAgIGlmICh0eXBlb2YgcHMgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBwcyA9IHBzLmNhbGwodm0pOwogICAgICB9CgogICAgICBpZiAocHMpIHsKICAgICAgICBpZiAodHlwZW9mIHBzWydpc1BhZ2UnXSA9PT0gJ2Jvb2xlYW4nKSB7CiAgICAgICAgICB2bS5pc1BhZ2UgPSBwc1snaXNQYWdlJ107CiAgICAgICAgICB0aGlzLmRhdGFUcmFuTWFuYWdlci5wYWdlRGF0YVNlcnZpY2UgPSBuZXcgQW55VHlwZVN0b3JlU2VydmljZSgpOyAvLyBjb25zb2xlLmxvZygiZGF0YVRyYW5NYW5hZ2VyLnBhZ2VEYXRhU2VydmljZSBjcmVhdGVkIik7CgogICAgICAgICAgdm0ucGFnZURhdGFTZXJ2aWNlID0gdGhpcy5kYXRhVHJhbk1hbmFnZXIucGFnZURhdGFTZXJ2aWNlOwogICAgICAgIH0KCiAgICAgICAgT2JqZWN0LmtleXMocHMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgaWYgKGtleSA9PT0gJ2lzUGFnZScpIHJldHVybjsKCiAgICAgICAgICBpZiAoIV90aGlzMi5wYXRoTWFwRm9yUGFnZS5oYXMoa2V5KSkgewogICAgICAgICAgICB2YXIgb3B0ID0gcHNba2V5XTsKICAgICAgICAgICAgdmFyIHN0b3JlS2V5ID0gb3B0LnBhdGggfHwga2V5OwogICAgICAgICAgICB2YXIgYXJncyA9IHsKICAgICAgICAgICAgICB2bTogdm0sCiAgICAgICAgICAgICAga2V5OiBrZXksCiAgICAgICAgICAgICAga2V5U3RvcmU6IHBzLAogICAgICAgICAgICAgIHJlY2VudGx5U2VudDoge30sCiAgICAgICAgICAgICAgc3RvcmVLZXk6IHN0b3JlS2V5LAogICAgICAgICAgICAgIGlzRm9yUGFnZTogdHJ1ZQogICAgICAgICAgICB9OwoKICAgICAgICAgICAgX3RoaXMyLnNldHVwU3RvcmVQcm9wZXJ0eShhcmdzKTsKCiAgICAgICAgICAgIGlmIChvcHQuc2hhcmVPbkNyZWF0ZWQpIHsKICAgICAgICAgICAgICBpZiAodm1ba2V5XSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICBhcmdzLnJlY2VudGx5U2VudCA9IHZtLnNlbmRQYWdlRGF0YSh2bVtrZXldLCBzdG9yZUtleSwgewogICAgICAgICAgICAgICAgICBrZXk6IGtleSwKICAgICAgICAgICAgICAgICAgcGF0aDogc3RvcmVLZXkKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oInVuZGVmaW5lZCBjYW5ub3Qgc2hhcmUgc28gc2hhcmVPbkNyZWF0ZWQgd2lsbCBiZSBpZ25vcmVkLiBbIi5jb25jYXQoa2V5LCAiXSIpKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF90aGlzMi5wYXRoTWFwRm9yUGFnZS5zZXQoa2V5LCBvcHQpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS53YXJuKCJkdXBsaWNhdGVkIHN0b3JlIGtleSBpcyBub3QgYWxsb3dlZC4gWyIuY29uY2F0KGtleSwgIl0iKSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHZhciBncyA9IHZtLiRvcHRpb25zLmdsb2JhbFN0b3JlOwoKICAgICAgaWYgKHR5cGVvZiBncyA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIGdzID0gZ3MuY2FsbCh2bSk7CiAgICAgIH0KCiAgICAgIGlmIChncykgewogICAgICAgIE9iamVjdC5rZXlzKGdzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgIGlmICghX3RoaXMyLnBhdGhNYXBGb3JHbG9iYWwuaGFzKGtleSkpIHsKICAgICAgICAgICAgdmFyIG9wdCA9IGdzW2tleV07CiAgICAgICAgICAgIHZhciBzdG9yZUtleSA9IG9wdC5wYXRoIHx8IGtleTsKICAgICAgICAgICAgdmFyIGFyZ3MgPSB7CiAgICAgICAgICAgICAgdm06IHZtLAogICAgICAgICAgICAgIGtleToga2V5LAogICAgICAgICAgICAgIGtleVN0b3JlOiBncywKICAgICAgICAgICAgICByZWNlbnRseVNlbnQ6IHt9LAogICAgICAgICAgICAgIHN0b3JlS2V5OiBzdG9yZUtleSwKICAgICAgICAgICAgICBpc0ZvclBhZ2U6IGZhbHNlCiAgICAgICAgICAgIH07CgogICAgICAgICAgICBfdGhpczIuc2V0dXBTdG9yZVByb3BlcnR5KGFyZ3MpOwoKICAgICAgICAgICAgX3RoaXMyLnBhdGhNYXBGb3JHbG9iYWwuc2V0KGtleSwgb3B0KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInNldHVwU3RvcmVQcm9wZXJ0eSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0dXBTdG9yZVByb3BlcnR5KGFyZ3MpIHsKICAgICAgLyp2bTphbnksIGtleTphbnksIGtleVN0b3JlOmFueSwgcmVjZW50bHlTZW50OmFueSwgc3RvcmVLZXk6c3RyaW5nLCBpc0ZvclBhZ2U6Ym9vbGVhbiAqLwogICAgICB2YXIgb3B0ID0gYXJncy5rZXlTdG9yZVthcmdzLmtleV07IC8vIGNvbnN0IHN0b3JlS2V5ID0gKG9wdC5wYXRoIHx8IGtleSkgYXMgc3RyaW5nOwogICAgICAvLyBjb25zb2xlLmxvZygncmVnaXN0ZXJpbmcgc2NvcHBlZCBzdG9yZSBmb3Iga2V5PScsIGtleSwgc3RvcmVLZXkpOwoKICAgICAgdmFyIG9uQmVmb3JlU2VuZENhbGxiYWNrID0gb3B0LmRpcmVjdGlvbiAhPT0gJ3JlYWQnICYmIG9wdC5vbkJlZm9yZVNlbmQgJiYgdHlwZW9mIG9wdC5vbkJlZm9yZVNlbmQgPT09ICdmdW5jdGlvbicgPyBvcHQub25CZWZvcmVTZW5kIDogbnVsbDsKICAgICAgdmFyIHJlY2VudGx5UmVjZXZpZWQgPSB7fTsgLy8gdG8gcHJldmVudCBmZWVkYmFjawogICAgICAvLyBsZXQgcmVjZW50bHlTZW50ID0ge307IC8vIHRvIHByZXZlbnQgZmVlZGJhY2sKCiAgICAgIHZhciBvbkJlZm9yZVNlbmQgPSBmdW5jdGlvbiBvbkJlZm9yZVNlbmQodmFsLCBvbGRWYWwpIHsKICAgICAgICAvLyBjb25zb2xlLmxvZygnY29uc3Qgb25CZWZvcmVTZW5kID0gKHZhbDphbnksIG9sZFZhbDphbnkpJywgCiAgICAgICAgLy8gICAgIHZhbCwgb2xkVmFsLHJlY2VudGx5UmVjZXZpZWQscmVjZW50bHlSZWNldmllZCAhPT0gdmFsKTsKICAgICAgICBpZiAoIV8uaXNFcXVhbChyZWNlbnRseVJlY2V2aWVkLCB2YWwpKSB7CiAgICAgICAgICB2YXIgc2VuZERhdGEgPSBvcHQuZGlyZWN0aW9uICE9PSAncmVhZCc7CgogICAgICAgICAgaWYgKG9uQmVmb3JlU2VuZENhbGxiYWNrKSB7CiAgICAgICAgICAgIHZhciBjYWxsYmFja09wdCA9IHsKICAgICAgICAgICAgICBwcm9jZWVkOiB0cnVlLAogICAgICAgICAgICAgIGtleTogYXJncy5rZXksCiAgICAgICAgICAgICAgcGF0aDogYXJncy5zdG9yZUtleQogICAgICAgICAgICB9OwoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBvbkJlZm9yZVNlbmRDYWxsYmFjayh2YWwsIG9sZFZhbCwgY2FsbGJhY2tPcHQpOwogICAgICAgICAgICAgIHNlbmREYXRhID0gY2FsbGJhY2tPcHQucHJvY2VlZDsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgIGNvbnNvbGUud2FybihlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmIChzZW5kRGF0YSkgewogICAgICAgICAgICBpZiAoYXJncy5pc0ZvclBhZ2UpIGFyZ3MucmVjZW50bHlTZW50ID0gYXJncy52bS5zZW5kUGFnZURhdGEodmFsLCBhcmdzLnN0b3JlS2V5LCB7CiAgICAgICAgICAgICAga2V5OiBhcmdzLmtleSwKICAgICAgICAgICAgICBwYXRoOiBhcmdzLnN0b3JlS2V5CiAgICAgICAgICAgIH0pO2Vsc2UgYXJncy5yZWNlbnRseVNlbnQgPSBhcmdzLnZtLnNlbmRHbG9iYWxEYXRhKHZhbCwgYXJncy5zdG9yZUtleSwgewogICAgICAgICAgICAgIGtleTogYXJncy5rZXksCiAgICAgICAgICAgICAgcGF0aDogYXJncy5zdG9yZUtleQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CgogICAgICBhcmdzLnZtLiR3YXRjaChhcmdzLmtleSwgb25CZWZvcmVTZW5kLCB7CiAgICAgICAgZGVlcDogISFvcHQuZGVlcCwKICAgICAgICBpbW1lZGlhdGU6ICEhb3B0LmltbWVkaWF0ZQogICAgICB9KTsKICAgICAgdmFyIGRhdGFDYWxsYmFjayA9IGFyZ3MuaXNGb3JQYWdlID8gYXJncy52bS5zZXRQYWdlRGF0YUNhbGxiYWNrIDogYXJncy52bS5zZXRHbG9iYWxEYXRhQ2FsbGJhY2s7CiAgICAgIHZhciBvbkJlZm9yZVJlY2VpdmUgPSBvcHQuZGlyZWN0aW9uICE9PSAnd3JpdGUnICYmIG9wdC5vbkJlZm9yZVJlY2VpdmUgJiYgdHlwZW9mIG9wdC5vbkJlZm9yZVJlY2VpdmUgPT09ICdmdW5jdGlvbicgPyBvcHQub25CZWZvcmVSZWNlaXZlIDogbnVsbDsKICAgICAgZGF0YUNhbGxiYWNrKGZ1bmN0aW9uIChkYXRhLCB1cGRhdGVyKSB7CiAgICAgICAgdmFyIHVwZGF0ZXJQYXRoID0gdXBkYXRlciAmJiB1cGRhdGVyLnBhdGggPyB1cGRhdGVyLnBhdGggOiAiIjsgLy/su7Ttj6zrhIztirgg7LSI6riw7ZmUIOuVjCAKICAgICAgICAvL+ydtCDsi5zsoJDsl5Ag7ZSE66Gc7Y287Yuw7JeQIHVuZGVmaW5k6rCAIOyEpOygleuQmOuptCAKICAgICAgICAvL+2UhOuhnO2NvO2LsOqwgCDrsJjsnZHshLEg6riw64ql7J2EIO2VmOyngCDrqrvtlZzri6QuCgogICAgICAgIGlmIChkYXRhID09PSB1bmRlZmluZWQpIHJldHVybjsKICAgICAgICB2YXIgbmVzdGVkID0gdXBkYXRlclBhdGgubGVuZ3RoID4gYXJncy5zdG9yZUtleS5sZW5ndGggJiYgdXBkYXRlclBhdGguc3RhcnRzV2l0aChhcmdzLnN0b3JlS2V5KTsKCiAgICAgICAgaWYgKGFyZ3MucmVjZW50bHlTZW50ICE9IGRhdGEgJiYgYXJncy52bVthcmdzLmtleV0gIT0gZGF0YSB8fCBuZXN0ZWQpIHsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCd2bS5zZXRQYWdlRGF0YUNhbGxiYWNrID0+IGlmIChyZWNlbnRseVNlbnQgIT0gZGF0YSAmJiB2bVtrZXldICE9IGRhdGEpJwogICAgICAgICAgLy8gICAgICwga2V5LCByZWNlbnRseVNlbnQsIGRhdGEsIHVwZGF0ZXJQYXRoLCBuZXN0ZWQsIHZtW2tleV0pOwogICAgICAgICAgdmFyIGFjY2VwdERhdGEgPSBvcHQuZGlyZWN0aW9uICE9PSAnd3JpdGUnOwoKICAgICAgICAgIGlmIChvbkJlZm9yZVJlY2VpdmUpIHsKICAgICAgICAgICAgdmFyIGNhbGxiYWNrT3B0ID0gewogICAgICAgICAgICAgIHByb2NlZWQ6IHRydWUsCiAgICAgICAgICAgICAga2V5OiBhcmdzLmtleSwKICAgICAgICAgICAgICBwYXRoOiBhcmdzLnN0b3JlS2V5LAogICAgICAgICAgICAgIHVwZGF0ZXJQYXRoOiB1cGRhdGVyUGF0aAogICAgICAgICAgICB9OwoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBvbkJlZm9yZVJlY2VpdmUoZGF0YSwgYXJncy52bVthcmdzLmtleV0sIGNhbGxiYWNrT3B0KTsKICAgICAgICAgICAgICBhY2NlcHREYXRhID0gY2FsbGJhY2tPcHQucHJvY2VlZDsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgIGNvbnNvbGUud2FybihlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmIChhY2NlcHREYXRhKSB7CiAgICAgICAgICAgIGlmIChfdHlwZW9mKGRhdGEpID09ICJvYmplY3QiKSB7CiAgICAgICAgICAgICAgLy92bVtrZXldID0gcmVjZW50bHlSZWNldmllZCA9IHsuLi5kYXRhfTsKICAgICAgICAgICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhkYXRhKS5mb3JFYWNoKGZ1bmN0aW9uICh2YWwpIHsKICAgICAgICAgICAgICAgIFZ1ZS5zZXQoYXJncy52bVthcmdzLmtleV0sIHZhbCwgZGF0YVt2YWxdKTsKICAgICAgICAgICAgICB9KTsgLy8gcmVjZW50bHlSZWNldmllZCA9IGRhdGE7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShkYXRhKSkgewogICAgICAgICAgICAgIHZhciB0YXJnZXRBcnJheSA9IGFyZ3Mudm1bYXJncy5rZXldOwogICAgICAgICAgICAgIHRhcmdldEFycmF5Lmxlbmd0aCA9IDA7CiAgICAgICAgICAgICAgZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgICB0YXJnZXRBcnJheS5wdXNoKGl0ZW0pOwogICAgICAgICAgICAgIH0pOyAvLyByZWNlbnRseVJlY2V2aWVkID0gZGF0YTsKICAgICAgICAgICAgICAvL3ZtW2tleV0gPSByZWNlbnRseVJlY2V2aWVkID0gWy4uLmRhdGFdOwogICAgICAgICAgICB9IGVsc2UgLy8gdm1ba2V5XSA9IHJlY2VudGx5UmVjZXZpZWQgPSBkYXRhOwogICAgICAgICAgICAgIGFyZ3Mudm1bYXJncy5rZXldID0gZGF0YTsKCiAgICAgICAgICAgIHJlY2VudGx5UmVjZXZpZWQgPSBfLmNsb25lRGVlcChhcmdzLnZtW2FyZ3Mua2V5XSk7IC8vIHZtLiRkYXRhW2tleV0gPSByZWNlbnRseVJlY2V2aWVkID0gZGF0YTsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2RhdGEgdXBkYXRlZCB3aXRoIHJlY2VpdmVkIG9uZScsIHZtW2tleV0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgYXJncy5zdG9yZUtleSk7CiAgICB9CiAgfSwgewogICAga2V5OiAic2VuZEdsb2JhbERhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNlbmRHbG9iYWxEYXRhKGRhdGEsIHN0b3JlUGF0aCwgc2VuZE9wdCkgewogICAgICB2YXIgc2VydmljZSA9IHRoaXMuZGF0YVRyYW5NYW5hZ2VyLmZpbmRPZkNyZWF0ZUdsb2JhbFNlcnZpY2UodGhpcy5nbG9iYWxEYXRhU2VydmljZUtleSk7CgogICAgICBpZiAoc2VydmljZSkgewogICAgICAgIGlmICghc2VuZE9wdCkgc2VuZE9wdCA9IHsKICAgICAgICAgIGlkZW50aXR5OiB0aGlzLnNlbmRlcklkZW50aXR5CiAgICAgICAgfTtlbHNlIGlmICghc2VuZE9wdC5pZGVudGl0eSkgc2VuZE9wdC5pZGVudGl0eSA9IHRoaXMuc2VuZGVySWRlbnRpdHk7CiAgICAgICAgc2VydmljZS5zZW5kRGF0YShkYXRhLCBzZW5kT3B0LCBzdG9yZVBhdGgpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0R2xvYmFsRGF0YUNhbGxiYWNrIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRHbG9iYWxEYXRhQ2FsbGJhY2soY2FsbGJhY2ssIHN0b3JlUGF0aCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHZhciBzZXJ2aWNlID0gdGhpcy5kYXRhVHJhbk1hbmFnZXIuZmluZE9mQ3JlYXRlR2xvYmFsU2VydmljZSh0aGlzLmdsb2JhbERhdGFTZXJ2aWNlS2V5KTsKCiAgICAgIGlmIChzZXJ2aWNlKSB7CiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zRm9yR2xvYmFsLnB1c2goc2VydmljZS4kc3RhdGUuc3Vic2NyaWJlKGZ1bmN0aW9uIChfcmVmKSB7CiAgICAgICAgICB2YXIgcGF5bG9hZCA9IF9yZWYucGF5bG9hZCwKICAgICAgICAgICAgICB1cGRhdGVyID0gX3JlZi51cGRhdGVyOwoKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmICh1cGRhdGVyLmlkZW50aXR5ID09PSBfdGhpczMuc2VuZGVySWRlbnRpdHkpIHJldHVybjsKCiAgICAgICAgICAgIHZhciBmaWx0ZXJlZCA9IF8uZ2V0KHBheWxvYWQsIHN0b3JlUGF0aCk7IC8vIGNvbnNvbGUubG9nKCdzZXRQYWdlRGF0YUNhbGxiYWNrID0+IHJlY2VpdmVkOicsIHBheWxvYWQsIHN0b3JlUGF0aCwgZmlsdGVyZWQpOwoKCiAgICAgICAgICAgIGlmIChmaWx0ZXJlZCAhPT0gdW5kZWZpbmVkKSBjYWxsYmFjayhmaWx0ZXJlZCwgdXBkYXRlcik7CiAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIGNvbnNvbGUud2Fybignc2V0R2xvYmFsRGF0YUNhbGxiYWNrJywgZSk7CiAgICAgICAgICB9CiAgICAgICAgfSkpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAic2VuZFBhZ2VEYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZW5kUGFnZURhdGEoZGF0YSwgcGF0aCwgc2VuZE9wdCkgewogICAgICB2YXIgX3RoaXMkZGF0YVRyYW5NYW5hZ2VyOwoKICAgICAgLy8gaWYgKCF0aGlzLmRhdGFUcmFuTWFuYWdlci5wYWdlRGF0YVNlcnZpY2UpCiAgICAgIC8vICAgICB0aGlzLmRhdGFUcmFuTWFuYWdlci5wYWdlRGF0YVNlcnZpY2UgPSBuZXcgQW55VHlwZVN0b3JlU2VydmljZSgpOwogICAgICAvLyBjb25zb2xlLmxvZygnc2VuZFBhZ2VEYXRhJywgZGF0YSwgcGF0aCk7CiAgICAgIGlmICghc2VuZE9wdCkgc2VuZE9wdCA9IHsKICAgICAgICBpZGVudGl0eTogdGhpcy5zZW5kZXJJZGVudGl0eQogICAgICB9O2Vsc2UgaWYgKCFzZW5kT3B0LmlkZW50aXR5KSBzZW5kT3B0LmlkZW50aXR5ID0gdGhpcy5zZW5kZXJJZGVudGl0eTsKICAgICAgcmV0dXJuIChfdGhpcyRkYXRhVHJhbk1hbmFnZXIgPSB0aGlzLmRhdGFUcmFuTWFuYWdlci5wYWdlRGF0YVNlcnZpY2UpID09PSBudWxsIHx8IF90aGlzJGRhdGFUcmFuTWFuYWdlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkZGF0YVRyYW5NYW5hZ2VyLnNlbmREYXRhKGRhdGEsIHNlbmRPcHQsIHBhdGgpOwogICAgfQogIH0sIHsKICAgIGtleTogInNldFBhZ2VEYXRhQ2FsbGJhY2siLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFBhZ2VEYXRhQ2FsbGJhY2soY2FsbGJhY2ssIHN0b3JlUGF0aCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIC8vIHRoaXMuaW5pdFBhZ2VEYXRhU2VydmljZSgpOwogICAgICBpZiAodGhpcy5kYXRhVHJhbk1hbmFnZXIucGFnZURhdGFTZXJ2aWNlKSB7CiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zRm9yUGFnZS5wdXNoKCAvLyB0aGlzLmRhdGFUcmFuTWFuYWdlci5wYWdlRGF0YVNlcnZpY2UuJHN0YXRlLnN1YnNjcmliZShzdGF0ZSA9PiB7CiAgICAgICAgdGhpcy5kYXRhVHJhbk1hbmFnZXIucGFnZURhdGFTZXJ2aWNlLiRzdGF0ZS5zdWJzY3JpYmUoZnVuY3Rpb24gKF9yZWYyKSB7CiAgICAgICAgICB2YXIgcGF5bG9hZCA9IF9yZWYyLnBheWxvYWQsCiAgICAgICAgICAgICAgdXBkYXRlciA9IF9yZWYyLnVwZGF0ZXI7CgogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKHVwZGF0ZXIuaWRlbnRpdHkgPT09IF90aGlzNC5zZW5kZXJJZGVudGl0eSkgcmV0dXJuOwoKICAgICAgICAgICAgdmFyIGZpbHRlcmVkID0gXy5nZXQocGF5bG9hZCwgc3RvcmVQYXRoKTsgLy8gY29uc29sZS5sb2coJ3NldFBhZ2VEYXRhQ2FsbGJhY2sgPT4gcmVjZWl2ZWQ6JywgcGF5bG9hZCwgc3RvcmVQYXRoLCBmaWx0ZXJlZCk7CgoKICAgICAgICAgICAgaWYgKGZpbHRlcmVkICE9PSB1bmRlZmluZWQpIGNhbGxiYWNrKGZpbHRlcmVkLCB1cGRhdGVyKTsKICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgY29uc29sZS53YXJuKCdzZXRQYWdlRGF0YUNhbGxiYWNrJywgZSk7CiAgICAgICAgICB9CiAgICAgICAgfSkpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAic2VuZFBhZ2VDb21tYW5kIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZW5kUGFnZUNvbW1hbmQoY29tbWFuZCwgYXJndW1lbnQpIHsKICAgICAgdmFyIF90aGlzJGRhdGFUcmFuTWFuYWdlcjI7CgogICAgICAvLyB0aGlzLmluaXRQYWdlRGF0YVNlcnZpY2UoKTsKICAgICAgKF90aGlzJGRhdGFUcmFuTWFuYWdlcjIgPSB0aGlzLmRhdGFUcmFuTWFuYWdlci5wYWdlRGF0YVNlcnZpY2UpID09PSBudWxsIHx8IF90aGlzJGRhdGFUcmFuTWFuYWdlcjIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJGRhdGFUcmFuTWFuYWdlcjIuc2VuZENvbW1hbmQoY29tbWFuZCwgYXJndW1lbnQpOwogICAgfQogIH0sIHsKICAgIGtleTogInNldFBhZ2VDb21tYW5kQ2FsbGJhY2siLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFBhZ2VDb21tYW5kQ2FsbGJhY2soY2FsbGJhY2spIHsKICAgICAgLy8gdGhpcy5pbml0UGFnZURhdGFTZXJ2aWNlKCk7CiAgICAgIGlmICh0aGlzLmRhdGFUcmFuTWFuYWdlci5wYWdlRGF0YVNlcnZpY2UpIHsKICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnNGb3JQYWdlLnB1c2godGhpcy5kYXRhVHJhbk1hbmFnZXIucGFnZURhdGFTZXJ2aWNlLiRjb21tYW5kLnN1YnNjcmliZShmdW5jdGlvbiAoY29tbWFuZCkgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY2FsbGJhY2soY29tbWFuZC5jb21tYW5kLCBjb21tYW5kLmFyZ3VtZW50KTsKICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgY29uc29sZS53YXJuKCdzZXRQYWdlQ29tbWFuZENhbGxiYWNrJywgZSk7CiAgICAgICAgICB9CiAgICAgICAgfSkpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAic2VuZEdsb2JhbENvbW1hbmQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNlbmRHbG9iYWxDb21tYW5kKGtleSwgY29tbWFuZCwgYXJndW1lbnQpIHsKICAgICAgdmFyIHNlcnZpY2UgPSB0aGlzLmRhdGFUcmFuTWFuYWdlci5maW5kT2ZDcmVhdGVHbG9iYWxTZXJ2aWNlKGtleSk7CgogICAgICBpZiAoc2VydmljZSkgewogICAgICAgIHNlcnZpY2Uuc2VuZENvbW1hbmQoY29tbWFuZCwgYXJndW1lbnQpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0R2xvYmFsQ29tbWFuZENhbGxiYWNrIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRHbG9iYWxDb21tYW5kQ2FsbGJhY2soa2V5LCBjYWxsYmFjaykgewogICAgICB2YXIgc2VydmljZSA9IHRoaXMuZGF0YVRyYW5NYW5hZ2VyLmZpbmRPZkNyZWF0ZUdsb2JhbFNlcnZpY2Uoa2V5KTsKCiAgICAgIGlmIChzZXJ2aWNlKSB7CiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zRm9yR2xvYmFsLnB1c2goc2VydmljZS4kY29tbWFuZC5zdWJzY3JpYmUoZnVuY3Rpb24gKGNvbW1hbmQpIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNhbGxiYWNrKGNvbW1hbmQuY29tbWFuZCwgY29tbWFuZC5hcmd1bWVudCk7CiAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIGNvbnNvbGUud2Fybignc2V0R2xvYmFsQ29tbWFuZENhbGxiYWNrJywgZSk7CiAgICAgICAgICB9CiAgICAgICAgfSkpOwogICAgICB9CiAgICB9CiAgfV0pOwoKICByZXR1cm4gU2NvcGVkU3RvcmVDb21wb25lbnQ7Cn0oVnVlKTsKClNjb3BlZFN0b3JlQ29tcG9uZW50ID0gX19kZWNvcmF0ZShbQ29tcG9uZW50XSwgU2NvcGVkU3RvcmVDb21wb25lbnQpOwpleHBvcnQgZGVmYXVsdCBTY29wZWRTdG9yZUNvbXBvbmVudDs="},{"version":3,"sources":["C:\\project\\scoped-store\\vue-scoped-store\\src\\scoped-store\\scoped-store-mixin.ts"],"names":[],"mappings":"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","sourcesContent":["import Component from 'vue-class-component';\r\nimport Vue from 'vue';\r\nimport _ from 'lodash';\r\n\r\nimport {AnyTypeStoreService, StringTypeCommand} from \"./core/any-type-store-service\";\r\nimport {scopedStoreManager} from \"./scoped-store-manager\";\r\nimport { Subscription } from 'rxjs';\r\n\r\nexport interface ScopedStore {\r\n}\r\n\r\ninterface SetupStorePropertyArg {\r\n    vm:any;\r\n    key:any;\r\n    keyStore:any;\r\n    recentlySent:any;\r\n    storeKey:string;\r\n    isForPage:boolean\r\n}\r\n\r\n@Component\r\nexport default class ScopedStoreComponent extends Vue {\r\n\r\n    private readonly dataTranManager = scopedStoreManager;\r\n    private readonly subscriptionsForPage:Subscription[] = [];\r\n    private readonly subscriptionsForGlobal:Subscription[] = [];\r\n\r\n    private readonly pathMapForPage = new Map<string,any>();\r\n    private readonly pathMapForGlobal = new Map<string,any>();\r\n\r\n    public isPage:boolean = false;\r\n    private pageDataService!:any;\r\n\r\n    created() {\r\n        // console.log('ScopedStoreComponent.created()');\r\n        this.init();\r\n    }\r\n\r\n    beforeDestroy() {\r\n        // console.log('ScopedStoreComponent.beforeDestroy()');\r\n        for (const k in this.subscriptionsForGlobal) {\r\n            this.subscriptionsForGlobal[k].unsubscribe();\r\n        }\r\n\r\n        for (const k in this.subscriptionsForPage) {\r\n            this.subscriptionsForPage[k].unsubscribe();\r\n        }\r\n\r\n        if (this.isPage) {\r\n            console.log('if (this.isPage) in ScopedStoreComponent.beforeDestroy()');\r\n            this.pageDataService?.stop();\r\n            // this.dataTranManager.pageDataService = undefined;\r\n        }\r\n    }\r\n\r\n    private init() {\r\n        const vm = this as any;\r\n\r\n        // console.log('ScopedStoreComponent.init()');\r\n\r\n        let ps = vm.$options.pageStore;\r\n        if (typeof ps === 'function') {\r\n            ps = ps.call(vm)\r\n        }\r\n        if (ps) {\r\n            if (typeof ps['isPage'] === 'boolean') {\r\n                vm.isPage = ps['isPage'];\r\n                this.dataTranManager.pageDataService = new AnyTypeStoreService();\r\n                // console.log(\"dataTranManager.pageDataService created\");\r\n                vm.pageDataService = this.dataTranManager.pageDataService;\r\n            }\r\n\r\n          Object.keys(ps).forEach(key => {\r\n            if (key === 'isPage' ) \r\n                return;\r\n\r\n            if (!this.pathMapForPage.has(key)) {\r\n                const opt = ps[key];\r\n                const storeKey = (opt.path || key) as string;\r\n                const args:SetupStorePropertyArg = {vm,key,keyStore:ps,recentlySent:{},storeKey,isForPage:true};\r\n                this.setupStoreProperty(args);\r\n\r\n                if (opt.shareOnCreated) {\r\n                    if (vm[key] !== undefined) {\r\n                        args.recentlySent = vm.sendPageData(vm[key], storeKey,{key, path:storeKey});\r\n                    }\r\n                    else {\r\n                        console.warn(`undefined cannot share so shareOnCreated will be ignored. [${key}]`);        \r\n                    }\r\n                }\r\n                this.pathMapForPage.set(key, opt);\r\n            }\r\n            else {\r\n                console.warn(`duplicated store key is not allowed. [${key}]`);\r\n            }\r\n          })\r\n        }\r\n\r\n        let gs = vm.$options.globalStore;\r\n        if (typeof gs === 'function') {\r\n            gs = gs.call(vm)\r\n        }\r\n        if (gs) {\r\n\r\n          Object.keys(gs).forEach(key => {\r\n            if (!this.pathMapForGlobal.has(key)) {\r\n                const opt = gs[key];\r\n                const storeKey = (opt.path || key) as string;\r\n                const args:SetupStorePropertyArg = {vm,key,keyStore:gs,recentlySent:{},storeKey,isForPage:false};\r\n                this.setupStoreProperty(args);\r\n\r\n                this.pathMapForGlobal.set(key, opt);\r\n            }\r\n            \r\n          })\r\n        }\r\n    }\r\n\r\n\r\n    private setupStoreProperty(args:SetupStorePropertyArg) {\r\n        /*vm:any, key:any, keyStore:any, recentlySent:any, storeKey:string, isForPage:boolean */\r\n        const opt = args.keyStore[args.key];\r\n        // const storeKey = (opt.path || key) as string;\r\n        // console.log('registering scopped store for key=', key, storeKey);\r\n        const onBeforeSendCallback = opt.direction !== 'read' && opt.onBeforeSend && typeof opt.onBeforeSend === 'function' ? opt.onBeforeSend : null;\r\n        let recentlyRecevied = {}; // to prevent feedback\r\n        // let recentlySent = {}; // to prevent feedback\r\n        const onBeforeSend = (val:any, oldVal:any) : any => {\r\n            // console.log('const onBeforeSend = (val:any, oldVal:any)', \r\n            //     val, oldVal,recentlyRecevied,recentlyRecevied !== val);\r\n            if (!_.isEqual(recentlyRecevied, val)) {\r\n                let sendData = opt.direction !== 'read';\r\n                if (onBeforeSendCallback) {\r\n                    const callbackOpt = {proceed:true, key:args.key, path:args.storeKey};\r\n                    try {\r\n                        onBeforeSendCallback(val, oldVal, callbackOpt);\r\n                        sendData = callbackOpt.proceed;\r\n                    }\r\n                    catch(e) {\r\n                        console.warn(e);\r\n                    }\r\n                }\r\n\r\n                if (sendData) {\r\n                    if (args.isForPage)\r\n                        args.recentlySent = args.vm.sendPageData(val, args.storeKey,{key:args.key, path:args.storeKey});\r\n                    else\r\n                        args.recentlySent = args.vm.sendGlobalData(val, args.storeKey,{key:args.key, path:args.storeKey});\r\n                }\r\n            }\r\n        }\r\n\r\n        args.vm.$watch(args.key, onBeforeSend, {deep:!!opt.deep,immediate:!!opt.immediate,});\r\n        const dataCallback = args.isForPage ? args.vm.setPageDataCallback : args.vm.setGlobalDataCallback;\r\n        const onBeforeReceive = opt.direction !== 'write' && opt.onBeforeReceive && typeof opt.onBeforeReceive === 'function' ? opt.onBeforeReceive : null;\r\n        dataCallback((data:any,updater?:any) => {\r\n            const updaterPath = updater && updater.path ? (updater.path as string) : \"\";\r\n\r\n            //컴포넌트 초기화 때 \r\n            //이 시점에 프로퍼티에 undefind가 설정되면 \r\n            //프로퍼티가 반응성 기능을 하지 못한다.\r\n            if (data === undefined)\r\n                return;\r\n            \r\n            const nested = updaterPath.length > args.storeKey.length && updaterPath.startsWith(args.storeKey);\r\n            if ((args.recentlySent != data && args.vm[args.key] != data) || nested) {\r\n                // console.log('vm.setPageDataCallback => if (recentlySent != data && vm[key] != data)'\r\n                //     , key, recentlySent, data, updaterPath, nested, vm[key]);\r\n                let acceptData = opt.direction !== 'write';\r\n                if (onBeforeReceive) {\r\n                    const callbackOpt = {proceed:true, key:args.key, path:args.storeKey, updaterPath};\r\n                    try {\r\n                        onBeforeReceive(data, args.vm[args.key], callbackOpt);\r\n                        acceptData = callbackOpt.proceed;\r\n                    }\r\n                    catch(e) {\r\n                        console.warn(e);\r\n                    }\r\n                }\r\n\r\n                if (acceptData) {\r\n                    if (typeof(data) == \"object\"){\r\n                        //vm[key] = recentlyRecevied = {...data};\r\n                        Object.getOwnPropertyNames(data).forEach(\r\n                            (val) => {\r\n                                Vue.set(args.vm[args.key], val, data[val]);\r\n                            }\r\n                        );\r\n                        // recentlyRecevied = data;\r\n                    }\r\n                    else if (Array.isArray(data)) {\r\n                        const targetArray = args.vm[args.key] as Array<any>;\r\n                        targetArray.length = 0;\r\n                        (data as Array<any>).forEach((item) => {\r\n                            targetArray.push(item);\r\n                        });\r\n                        // recentlyRecevied = data;\r\n                        //vm[key] = recentlyRecevied = [...data];\r\n                    }\r\n                    else\r\n                        // vm[key] = recentlyRecevied = data;\r\n                        args.vm[args.key] = data;\r\n\r\n                    recentlyRecevied = _.cloneDeep(args.vm[args.key]);\r\n                    // vm.$data[key] = recentlyRecevied = data;\r\n                    // console.log('data updated with received one', vm[key]);\r\n                }\r\n            }\r\n        }, args.storeKey);\r\n    }\r\n\r\n    // private initPageDataService() {\r\n    //     if (!this.dataTranManager.pageDataService) {\r\n    //         this.dataTranManager.pageDataService = new AnyTypeStoreService();\r\n    //         console.log(\"dataTranManager.pageDataService created\");\r\n    //     }\r\n    // }\r\n\r\n    private readonly senderIdentity = {};\r\n    private readonly globalDataServiceKey = \"$$GLOBAL_STORE_SERVICE$$\";\r\n\r\n    public sendGlobalData(data:any, storePath:string, sendOpt?:any) {\r\n        const service : AnyTypeStoreService | undefined  = this.dataTranManager.findOfCreateGlobalService(this.globalDataServiceKey);\r\n        if (service) {\r\n            if (!sendOpt) \r\n                sendOpt = {identity:this.senderIdentity};\r\n            else if (!sendOpt.identity)\r\n                sendOpt.identity = this.senderIdentity;\r\n            service.sendData(data, sendOpt, storePath);\r\n        }\r\n    }\r\n\r\n    public setGlobalDataCallback(callback: (data: any, updater?:any) => void, storePath:string) {\r\n        const service : AnyTypeStoreService | undefined  = this.dataTranManager.findOfCreateGlobalService(this.globalDataServiceKey);\r\n        if (service) {\r\n            this.subscriptionsForGlobal.push(\r\n                service.$state.subscribe(({payload,updater}) => {\r\n                    try {\r\n                        if (updater.identity === this.senderIdentity)\r\n                            return;\r\n                        const filtered = _.get(payload, storePath);\r\n                        // console.log('setPageDataCallback => received:', payload, storePath, filtered);\r\n                        if (filtered !== undefined)\r\n                            callback(filtered, updater);\r\n                    } catch (e) {\r\n                        console.warn('setGlobalDataCallback', e);\r\n                    }\r\n                })\r\n            );\r\n        }\r\n    }\r\n\r\n    public sendPageData(data:any, path:string, sendOpt?:any) {\r\n        // if (!this.dataTranManager.pageDataService)\r\n        //     this.dataTranManager.pageDataService = new AnyTypeStoreService();\r\n\r\n        // console.log('sendPageData', data, path);\r\n        if (!sendOpt) \r\n            sendOpt = {identity:this.senderIdentity};\r\n        else if (!sendOpt.identity)\r\n            sendOpt.identity = this.senderIdentity;\r\n            \r\n        return this.dataTranManager.pageDataService?.sendData(data, sendOpt, path);\r\n    }\r\n\r\n    public setPageDataCallback(callback: (data: any, updater?:any) => void, storePath:string) {\r\n        // this.initPageDataService();\r\n\r\n        if (this.dataTranManager.pageDataService) {\r\n            this.subscriptionsForPage.push(\r\n                // this.dataTranManager.pageDataService.$state.subscribe(state => {\r\n                this.dataTranManager.pageDataService.$state.subscribe(({payload,updater}) => {\r\n                    try {\r\n                        if (updater.identity === this.senderIdentity)\r\n                            return;\r\n                        const filtered = _.get(payload, storePath);\r\n                        // console.log('setPageDataCallback => received:', payload, storePath, filtered);\r\n                        if (filtered !== undefined)\r\n                            callback(filtered, updater);\r\n                    } catch (e) {\r\n                        console.warn('setPageDataCallback', e);\r\n                    }\r\n                })\r\n            );\r\n        }\r\n    }\r\n\r\n    public sendPageCommand(command:string, argument?:any) {\r\n        // this.initPageDataService();\r\n        \r\n        this.dataTranManager.pageDataService?.sendCommand(command, argument);\r\n    }\r\n\r\n    public setPageCommandCallback(callback: (command:string, argument?:any) => void) {\r\n        // this.initPageDataService();\r\n\r\n        if (this.dataTranManager.pageDataService) {\r\n            this.subscriptionsForPage.push(\r\n                this.dataTranManager.pageDataService.$command.subscribe(command => {\r\n                    try {\r\n                        callback(command.command, command.argument);\r\n                    } catch (e) {\r\n                        console.warn('setPageCommandCallback', e);\r\n                    }\r\n                })\r\n            );\r\n        }\r\n\r\n    }\r\n\r\n    public sendGlobalCommand(key:string, command:string, argument?:any) {\r\n        const service = this.dataTranManager.findOfCreateGlobalService(key);\r\n        if (service) {\r\n            service.sendCommand(command, argument);\r\n        }\r\n    }\r\n\r\n    public setGlobalCommandCallback(key:string, callback: (command: string, argument?: any) => void) {\r\n        const service : AnyTypeStoreService | undefined  = this.dataTranManager.findOfCreateGlobalService(key);\r\n        if (service) {\r\n            this.subscriptionsForGlobal.push(\r\n                service.$command.subscribe((command:StringTypeCommand) => {\r\n                    try {\r\n                        callback(command.command, command.argument);\r\n                    } catch (e) {\r\n                        console.warn('setGlobalCommandCallback', e);\r\n                    }\r\n                })\r\n            );\r\n        }\r\n    }\r\n}"],"sourceRoot":""}]}